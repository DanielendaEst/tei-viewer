TRACTATUS COORDINATE SCALING FIX
================================

Problem Identified
------------------
The Tractatus-Fascinatione project had misaligned highlights because:

1. Image filename: XML referenced "images/p004.jpg" instead of "images/p1.jpg"
2. Dimension mismatch: 
   - XML declared: 2479 × 3508 pixels
   - Actual image: 960 × 1358 pixels
3. Zone coordinates were in the 2479×3508 space but image was 960×1358
4. Result: Highlights appeared ~2.58x too large and offset

Root Cause
----------
The TEI files were generated from PAGE-XML that referenced a high-resolution
scan (2479×3508). Later, the image was downsampled to 960×1358 for web delivery,
but the XML coordinates were never rescaled.

Solution Applied
----------------
Created and ran fix_tractatus_coords.py which:

1. Updated <graphic> element:
   - Changed: url="images/p004.jpg" → url="images/p1.jpg"
   - Changed: width="2479px" → width="960px"
   - Changed: height="3508px" → height="1358px"

2. Scaled all 37 zone coordinates:
   - Scale factors: X=0.3873, Y=0.3871
   - Example: (264,199) → (102,77)
   - Example: (2088,203) → (809,79)

3. Applied to both files:
   - p1_dip.xml (diplomatic edition)
   - p1_trad.xml (translation)

Verification
------------
Before fix:
  Dimensiones Declaradas: 0 × 0 píxeles (bug in display)
  Dimensiones Intrínsecas: 960 × 1358 píxeles
  Highlights: Misaligned

After fix:
  Dimensiones Declaradas: 960 × 1358 píxeles
  Dimensiones Intrínsecas: 960 × 1358 píxeles
  Highlights: Should now align correctly

General Pattern
---------------
This is a common issue when:
- PAGE-XML created on high-res master scans
- Images downsampled for web delivery
- TEI conversion doesn't account for rescaling

Always ensure:
  declared_dimensions == actual_image_dimensions
  zone_coordinates in same space as image

Files Changed
-------------
- projects/Tractatus-Fascinatione/p1_dip.xml (37 zones rescaled)
- projects/Tractatus-Fascinatione/p1_trad.xml (37 zones rescaled)
- projects/Tractatus-Fascinatione/images/p1.jpg (copied from p004.jpg)

Status: ✅ FIXED
